<ng-template #addTitheModal let-modal>
  <div class="modal-header tithe-modal-header">
    <div>
      <h5 class="modal-title mb-1">Add One Tithe</h5>
      <p class="modal-subtitle mb-0">Record a single giving entry quickly.</p>
    </div>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss()"
    ></button>
  </div>

  <div class="modal-body">
    <form [formGroup]="titheForm">
      <div class="mb-3">
        <label class="form-label">Date Received</label>
        <input
          type="date"
          class="form-control form-control-lg"
          formControlName="dateReceived"
        />

        @if(dateReceived.invalid && dateReceived.touched){
        <small class="field-error">Date Received is required.</small>
        }
      </div>

      <div class="mb-3">
        <label class="form-label">Amount (PHP)</label>
        <input
          type="text"
          class="form-control form-control-lg"
          id="amount"
          placeholder="0.00"
          formControlName="amount"
          (input)="formatToTwoDecimals($event)"
        />

        @if(amount.invalid && amount.touched){
        <small class="field-error">Amount is required.</small>
        }
      </div>

      <app-active-tithe-type-dropdown (emitTitheTypeId)="setTitheType($event)">
        @if(titheTypeId.invalid && titheTypeId.touched){
        <small class="field-error">Type is required.</small>
        }</app-active-tithe-type-dropdown
      >

      @if(!memberId.value){
      <app-active-members-lookup-dropdown
        (emitMemberName)="onMemberSelect($event)"
        (emitMemberId)="onMemberSelectId($event)"
      />
      } @if(memberId.value){
      <div class="mb-3" style="position: relative">
        <label class="form-label">Member Name</label>
        <input
          type="string"
          class="form-control form-control-lg"
          formControlName="memberName"
        />
        @if(memberId.value){
        <div class="remove-icon" (click)="removeMemberNameAndId()">
          <i class="bi bi-x-square-fill"></i>
        </div>
        }
      </div>
      } @if((memberName.invalid && memberName.touched) || memberId.invalid &&
      memberId.touched){
      <small class="field-error">Member is required.</small>
      }
    </form>
  </div>

  <div class="modal-footer border-0 pt-0">
    <button class="btn btn-light rounded-pill px-4" (click)="modal.dismiss()">Cancel</button>
    <button class="btn btn-primary rounded-pill px-4" (click)="saveTithe(modal)">Save Tithe</button>
  </div>
</ng-template>
