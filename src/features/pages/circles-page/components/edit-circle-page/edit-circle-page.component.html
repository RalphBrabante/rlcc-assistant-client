<main class="app-page edit-circle-page">
  <div class="app-shell">
    <section class="app-shell-head d-flex justify-content-between align-items-start gap-2 flex-wrap">
      <div>
        <h2>Edit Group</h2>
        <p class="app-shell-subtitle mb-0">Update circle details and classification.</p>
      </div>
      <button class="btn btn-sm btn-outline-secondary" type="button" (click)="goBack()">Back</button>
    </section>

    <section class="app-shell-body">
      @if (loading()) {
      <p class="text-muted mb-0">Loading circle details...</p>
      } @else {
      <form [formGroup]="form" (ngSubmit)="save()" class="edit-form">
        <div class="mb-3">
          <label class="form-label">Group Name</label>
          <input type="text" class="form-control" formControlName="name" />
          @if (name.invalid && name.touched) {
          <small class="text-danger">Group name is required and must be 120 chars or fewer.</small>
          }
        </div>

        <div class="mb-3">
          <label class="form-label">Group Type</label>
          <select class="form-select" formControlName="groupTypeId">
            <option [ngValue]="null">Select circle type</option>
            @for (type of groupTypes(); track type.id) {
            <option [ngValue]="type.id">{{ type.name }}</option>
            }
          </select>
          @if (groupTypeId.invalid && groupTypeId.touched) {
          <small class="text-danger">Group type is required.</small>
          }
        </div>

        <div class="form-check form-switch mb-3">
          <input class="form-check-input" type="checkbox" formControlName="isActive" id="isActive" />
          <label class="form-check-label" for="isActive">Active</label>
        </div>

        @if (errorMessage()) {
        <div class="alert alert-danger py-2">{{ errorMessage() }}</div>
        }
        @if (successMessage()) {
        <div class="alert alert-success py-2">{{ successMessage() }}</div>
        }

        <div class="d-flex justify-content-end">
          <button class="btn btn-primary" type="submit" [disabled]="saving()">
            {{ saving() ? 'Saving...' : 'Save Changes' }}
          </button>
        </div>
      </form>
      }
    </section>
  </div>
</main>
