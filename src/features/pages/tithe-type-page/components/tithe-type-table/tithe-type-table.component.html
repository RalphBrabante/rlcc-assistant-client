<!-- Modal -->
<app-create-tithe-type-modal (saveTithe)="fetchData()" />

<div class="tithe-types-card">
  <div class="card-toolbar">
    <div>
      <h5 class="mb-1">Tithe Categories</h5>
      <p class="mb-0 text-muted">Configure giving categories used in tithe entries.</p>
    </div>
    <div class="toolbar-actions">
      <span class="type-count">{{ titheTypes().length }} total</span>
      <button
        class="btn btn-primary btn-sm"
        data-bs-toggle="modal"
        data-bs-target="#titheCreateModal"
      >
        <i class="bi bi-plus-circle me-1"></i>
        Add Tithe Type
      </button>
    </div>
  </div>

  <ngb-alert type="danger" *ngIf="errorMessage()" (closed)="errorMessage.set('')">
    {{ errorMessage() }}
  </ngb-alert>

  <div class="table-responsive">
    <table class="table table-hover align-middle mb-0 tithe-types-table">
      <thead>
        <tr>
          <th scope="col">Type Name</th>
          <th scope="col">Status</th>
          <th scope="col">Last Updated</th>
          <th scope="col" class="text-end">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngIf="isLoading()">
          <td colspan="4" class="text-center text-muted py-4">Loading tithe types...</td>
        </tr>

        <tr *ngFor="let titheType of titheTypes()">
          <td class="fw-semibold">{{ titheType.name }}</td>
          <td>
            <span class="status-pill" [class.inactive]="!titheType.isActive">
              {{ titheType.isActive ? "Active" : "Inactive" }}
            </span>
          </td>
          <td>{{ titheType.updatedAt | date:'MMM d, y, h:mm a' }}</td>
          <td class="text-end">
            <button
              class="btn btn-outline-secondary btn-sm me-2"
              ngbTooltip="Edit"
              placement="top"
              container="body"
              [routerLink]="['edit/', titheType.id]"
              *ngIf="isAdmin() || isSuperUser()"
            >
              <i class="bi bi-pencil"></i>
            </button>

            <button
              class="btn btn-outline-danger btn-sm"
              ngbTooltip="Delete"
              placement="top"
              container="body"
              *ngIf="isAdmin() || isSuperUser()"
              (click)="onDeleteTithes(titheType.id)"
            >
              <i class="bi bi-trash"></i>
            </button>
          </td>
        </tr>

        <tr *ngIf="!isLoading() && titheTypes().length === 0">
          <td colspan="4" class="text-center text-muted py-4">No tithe types found.</td>
        </tr>
      </tbody>
    </table>
  </div>
    </div>
